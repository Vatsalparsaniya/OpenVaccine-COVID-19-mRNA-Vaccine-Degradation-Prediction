
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Feature extraction &#8212; 🍀 Co-weed&#39;19</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="structure augmentation" href="augmentation.html" />
    <link rel="prev" title="Stratification by the signal_to_noise" href="CV_strategy.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo_1.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">🍀 Co-weed'19</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Introduction/Introduction.html">
   🙋🏻‍♂️ Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  🤔 Project Overview
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Project_Overview/description.html">
   Description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Project_Overview/evaluation.html">
   Evaluation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  🔍 Exploratory Data Analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../EDA/openvaccine-eda.html">
   EDA by Vatsal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../EDA/openvaccine-interesting-visualizations.html">
   EDA by Meet
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  🧪 Things we tried
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="CV_strategy.html">
   Stratification by the signal_to_noise
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Feature extraction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="augmentation.html">
   structure augmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvaccine-t-sne-rapids.html">
   T-SNE - Rapids
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  💡 Our Solution
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Our_solution/openvaccine-model-training-augmentation.html">
   Vatsal’s Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Our_solution/Single_model_Perfomance.html">
   Vatsal’s Single Model Details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Our_solution/openvaccine-transformers-lstm-gru.html">
   Meet’s code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Our_solution/single-model-results.html">
   Meet’s Single Models Details
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Our_solution/ensemblingResults.html">
   Ensemble Results
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  📝 Reference Material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Reference_material/index.html">
   Material
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  🗣 Discussion Forum Material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Discussion_material/tsne_visualization.html">
   TSNE visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Discussion_material/Graph_representation_of_RNA.html">
   Graph representation of RNA
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Things_we_tried/openvaccine-feature-extraction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Things_we_tried/openvaccine-feature-extraction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/Things_we_tried/openvaccine-feature-extraction.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-packages">
   Install Packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#library-imports">
   Library Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-import">
   Data Import
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-data-overview">
   Train Data Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-data-overview">
   Test Data Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#new-feature-overview">
   New Feature Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-graph-matrices-from-the-structures">
   Generating Graph Matrices from the Structures
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abs-difference-between-graph-matrix-and-bpps">
   1. Abs-Difference between Graph Matrix and BPPS
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loop-count">
   2. Loop-Count
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iterate-over-all-pairs-of-connected-stems">
   3. Iterate over all pairs of connected stems.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#elements-present-in-rna">
   4. Elements Present in RNA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#element-length-of-each-element">
   5. Element_Length of each element.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-list-containing-the-sequence-s-corresponding-to-the-defines">
   6. A list containing the sequence(s) corresponding to the defines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-minimum-spanning-tree-from-this-bulgegraph-this-is-useful">
   7. Create a minimum spanning tree from this BulgeGraph. This is useful
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-the-minimum-and-maximum-base-pair-distance-between-2-elements">
   8. Get the minimum and maximum base pair distance between 2 elements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-mfe-prediction-for-a-given-sequence">
   9. Simple MFE prediction for a given sequence
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#https-www-tbi-univie-ac-at-rna-viennarna-doc-html-helloworld-swig-html-helloworld-python">
     https://www.tbi.univie.ac.at/RNA/ViennaRNA/doc/html/helloworld_swig.html#helloworld_python
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loop-type-non-sequencial-probablity">
   Loop-type (Non Sequencial) Probablity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#process-inputs-2-here">
   process_inputs_2 : here
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sequencial-feature-generation">
   Sequencial Feature Generation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementing-sliding-window-features">
   Implementing Sliding Window Features
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sliding-window-pair-features">
     Sliding Window Pair Features
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-mfe-mea-centroid-structure">
   Compute MFE,MEA ,Centroid Structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loop-typefeaure-generation-mfe-mea-centroid-structure">
   Loop TypeFeaure Generation (MFE,MEA ,Centroid Structure)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternate-method">
     Alternate Method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bpps-sequence-feature">
   BPPS Sequence Feature
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checking">
     checking
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pair-map">
   Pair Map
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#final-train-and-test-data">
   Final Train And Test Data
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="feature-extraction">
<h1>Feature extraction<a class="headerlink" href="#feature-extraction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="install-packages">
<h2>Install Packages<a class="headerlink" href="#install-packages" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%capture
!pip install forgi
!yes Y |conda install -c bioconda viennarna
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="library-imports">
<h2>Library Imports<a class="headerlink" href="#library-imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Counter</span>

<span class="kn">import</span> <span class="nn">RNA</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">forgi.graph</span> <span class="k">import</span> <span class="n">bulge_graph</span>
<span class="kn">import</span> <span class="nn">forgi.visual.mplotlib</span> <span class="k">as</span> <span class="nn">fvm</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">SVG</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">colorama</span> <span class="k">import</span> <span class="n">Fore</span><span class="p">,</span> <span class="n">Back</span><span class="p">,</span> <span class="n">Style</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-import">
<h2>Data Import<a class="headerlink" href="#data-import" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/kaggle/input/stanford-covid-vaccine&#39;</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{path}</span><span class="s1">/train.json&#39;</span><span class="p">,</span><span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{path}</span><span class="s1">/test.json&#39;</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{path}</span><span class="s1">/sample_submission.csv&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train set sequences: &#39;</span><span class="p">,</span> <span class="n">train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test set sequences: &#39;</span><span class="p">,</span> <span class="n">test_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train set sequences:  (2400, 19)
Test set sequences:  (3634, 7)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="train-data-overview">
<h2>Train Data Overview<a class="headerlink" href="#train-data-overview" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>sequence</th>
      <th>structure</th>
      <th>predicted_loop_type</th>
      <th>signal_to_noise</th>
      <th>SN_filter</th>
      <th>seq_length</th>
      <th>seq_scored</th>
      <th>reactivity_error</th>
      <th>deg_error_Mg_pH10</th>
      <th>deg_error_pH10</th>
      <th>deg_error_Mg_50C</th>
      <th>deg_error_50C</th>
      <th>reactivity</th>
      <th>deg_Mg_pH10</th>
      <th>deg_pH10</th>
      <th>deg_Mg_50C</th>
      <th>deg_50C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id_001f94081</td>
      <td>GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUA...</td>
      <td>.....((((((.......)))).)).((.....((..((((((......</td>
      <td>EEEEESSSSSSHHHHHHHSSSSBSSXSSIIIIISSIISSSSSSHHH...</td>
      <td>6.894</td>
      <td>1</td>
      <td>107</td>
      <td>68</td>
      <td>[0.1359, 0.20700000000000002, 0.1633, 0.1452, ...</td>
      <td>[0.26130000000000003, 0.38420000000000004, 0.1...</td>
      <td>[0.2631, 0.28600000000000003, 0.0964, 0.1574, ...</td>
      <td>[0.1501, 0.275, 0.0947, 0.18660000000000002, 0...</td>
      <td>[0.2167, 0.34750000000000003, 0.188, 0.2124, 0...</td>
      <td>[0.3297, 1.5693000000000001, 1.1227, 0.8686, 0...</td>
      <td>[0.7556, 2.983, 0.2526, 1.3789, 0.637600000000...</td>
      <td>[2.3375, 3.5060000000000002, 0.3008, 1.0108, 0...</td>
      <td>[0.35810000000000003, 2.9683, 0.2589, 1.4552, ...</td>
      <td>[0.6382, 3.4773, 0.9988, 1.3228, 0.78770000000...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id_0049f53ba</td>
      <td>GGAAAAAGCGCGCGCGGUUAGCGCGCGCUUUUGCGCGCGCUGUACC...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>EEEEESSSSSSSSSSSSSSSSSSSSSSSHHHHSSSSSSSSSSBSSS...</td>
      <td>0.193</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[2.8272, 2.8272, 2.8272, 4.7343, 2.5676, 2.567...</td>
      <td>[73705.3985, 73705.3985, 73705.3985, 73705.398...</td>
      <td>[10.1986, 9.2418, 5.0933, 5.0933, 5.0933, 5.09...</td>
      <td>[16.6174, 13.868, 8.1968, 8.1968, 8.1968, 8.19...</td>
      <td>[15.4857, 7.9596, 13.3957, 5.8777, 5.8777, 5.8...</td>
      <td>[0.0, 0.0, 0.0, 2.2965, 0.0, 0.0, 0.0, 0.0, 0....</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[4.947, 4.4523, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[4.8511, 4.0426, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
      <td>[7.6692, 0.0, 10.9561, 0.0, 0.0, 0.0, 0.0, 0.0...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id_006f36f57</td>
      <td>GGAAAGUGCUCAGAUAAGCUAAGCUCGAAUAGCAAUCGAAUAGAAU...</td>
      <td>.....((((.((.....((((.(((.....)))..((((......)...</td>
      <td>EEEEESSSSISSIIIIISSSSMSSSHHHHHSSSMMSSSSHHHHHHS...</td>
      <td>8.800</td>
      <td>1</td>
      <td>107</td>
      <td>68</td>
      <td>[0.0931, 0.13290000000000002, 0.11280000000000...</td>
      <td>[0.1365, 0.2237, 0.1812, 0.1333, 0.1148, 0.160...</td>
      <td>[0.17020000000000002, 0.178, 0.111, 0.091, 0.0...</td>
      <td>[0.1033, 0.1464, 0.1126, 0.09620000000000001, ...</td>
      <td>[0.14980000000000002, 0.1761, 0.1517, 0.116700...</td>
      <td>[0.44820000000000004, 1.4822, 1.1819, 0.743400...</td>
      <td>[0.2504, 1.4021, 0.9804, 0.49670000000000003, ...</td>
      <td>[2.243, 2.9361, 1.0553, 0.721, 0.6396000000000...</td>
      <td>[0.5163, 1.6823000000000001, 1.0426, 0.7902, 0...</td>
      <td>[0.9501000000000001, 1.7974999999999999, 1.499...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id_0082d463b</td>
      <td>GGAAAAGCGCGCGCGCGCGCGCGAAAAAGCGCGCGCGCGCGCGCGC...</td>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
      <td>EEEEEESSSSSSSSSSSSSSSSHHHHHHSSSSSSSSSSSSSSSSSS...</td>
      <td>0.104</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[3.5229, 6.0748, 3.0374, 3.0374, 3.0374, 3.037...</td>
      <td>[73705.3985, 73705.3985, 73705.3985, 73705.398...</td>
      <td>[11.8007, 12.7566, 5.7733, 5.7733, 5.7733, 5.7...</td>
      <td>[121286.7181, 121286.7182, 121286.7181, 121286...</td>
      <td>[15.3995, 8.1124, 7.7824, 7.7824, 7.7824, 7.78...</td>
      <td>[0.0, 2.2399, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0....</td>
      <td>[0.0, -0.5083, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0...</td>
      <td>[3.4248, 6.8128, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
      <td>[0.0, -0.8365, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0...</td>
      <td>[7.6692, -1.3223, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id_0087940f4</td>
      <td>GGAAAAUAUAUAAUAUAUUAUAUAAAUAUAUUAUAGAAGUAUAAUA...</td>
      <td>.....(((((((.((((((((((((.(((((((((....)))))))...</td>
      <td>EEEEESSSSSSSBSSSSSSSSSSSSBSSSSSSSSSHHHHSSSSSSS...</td>
      <td>0.423</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[1.665, 2.1728, 2.0041, 1.2405, 0.620200000000...</td>
      <td>[4.2139, 3.9637000000000002, 3.2467, 2.4716, 1...</td>
      <td>[3.0942, 3.015, 2.1212, 2.0552, 0.881500000000...</td>
      <td>[2.6717, 2.4818, 1.9919, 2.5484999999999998, 1...</td>
      <td>[1.3285, 3.6173, 1.3057, 1.3021, 1.1507, 1.150...</td>
      <td>[0.8267, 2.6577, 2.8481, 0.40090000000000003, ...</td>
      <td>[2.1058, 3.138, 2.5437000000000003, 1.0932, 0....</td>
      <td>[4.7366, 4.6243, 1.2068, 1.1538, 0.0, 0.0, 0.7...</td>
      <td>[2.2052, 1.7947000000000002, 0.7457, 3.1233, 0...</td>
      <td>[0.0, 5.1198, -0.3551, -0.3518, 0.0, 0.0, 0.0,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="test-data-overview">
<h2>Test Data Overview<a class="headerlink" href="#test-data-overview" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>sequence</th>
      <th>structure</th>
      <th>predicted_loop_type</th>
      <th>seq_length</th>
      <th>seq_scored</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id_00073f8be</td>
      <td>GGAAAAGUACGACUUGAGUACGGAAAACGUACCAACUCGAUUAAAA...</td>
      <td>......((((((((((.(((((.....))))))))((((((((......</td>
      <td>EEEEEESSSSSSSSSSBSSSSSHHHHHSSSSSSSSSSSSSSSSHHH...</td>
      <td>107</td>
      <td>68</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id_000ae4237</td>
      <td>GGAAACGGGUUCCGCGGAUUGCUGCUAAUAAGAGUAAUCUCUAAAU...</td>
      <td>.....((((..((((((...(((((.....((((....)))).......</td>
      <td>EEEEESSSSIISSSSSSIIISSSSSIIIIISSSSHHHHSSSSIIII...</td>
      <td>130</td>
      <td>91</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id_00131c573</td>
      <td>GGAAAACAAAACGGCCUGGAAGACGAAGGAAUUCGGCGCGAAGGCC...</td>
      <td>...........((.(((.(.(..((..((..((((...))))..))...</td>
      <td>EEEEEEEEEEESSISSSISISIISSIISSIISSSSHHHSSSSIISS...</td>
      <td>107</td>
      <td>68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id_00181fd34</td>
      <td>GGAAAGGAUCUCUAUCGAAGGAUAGAGAUCGCUCGCGACGGCACGA...</td>
      <td>......((((((((((....))))))))))((((((..((.(((.....</td>
      <td>EEEEEESSSSSSSSSSHHHHSSSSSSSSSSSSSSSSIISSISSSHH...</td>
      <td>107</td>
      <td>68</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id_0020473f7</td>
      <td>GGAAACCCGCCCGCGCCCGCCCGCGCUGCUGCCGUGCCUCCUCUCC...</td>
      <td>.....(((((((((((((((((((((((((((((((((((((((((...</td>
      <td>EEEEESSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS...</td>
      <td>130</td>
      <td>91</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="new-feature-overview">
<h2>New Feature Overview<a class="headerlink" href="#new-feature-overview" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Select_id</span> <span class="o">=</span> <span class="s2">&quot;id_001f94081&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sequence</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Select_id</span><span class="p">][</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">structure</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Select_id</span><span class="p">][</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">predicted_loop_type</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Select_id</span><span class="p">][</span><span class="s2">&quot;predicted_loop_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">structure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sequence :&quot;</span><span class="p">,</span><span class="n">Sequence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Structure :&quot;</span><span class="p">,</span><span class="n">structure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted Loop type :&quot;</span><span class="p">,</span><span class="n">predicted_loop_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generated Loop type :&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sequence : GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUAACUGGAAUAACCCAUACCAGCAGUUAGAGUUCGCUCUAACAAAAGAAACAACAACAACAAC
Structure : .....((((((.......)))).)).((.....((..((((((....))))))..)).....))....(((((((....))))))).....................
Predicted Loop type : EEEEESSSSSSHHHHHHHSSSSBSSXSSIIIIISSIISSSSSSHHHHSSSSSSIISSIIIIISSXXXXSSSSSSSHHHHSSSSSSSEEEEEEEEEEEEEEEEEEEEE
Generated Loop type : fffffsssssshhhhhhhssssissmssiiiiissiisssssshhhhssssssiissiiiiissmmmmssssssshhhhsssssssttttttttttttttttttttt
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">fvm</span><span class="o">.</span><span class="n">plot_rna</span><span class="p">(</span><span class="n">bg</span><span class="p">,</span> <span class="n">text_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontweight&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">},</span> <span class="n">lighten</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
             <span class="n">backbone_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/openvaccine-feature-extraction_14_0.png" src="../_images/openvaccine-feature-extraction_14_0.png" />
</div>
</div>
</div>
<div class="section" id="generating-graph-matrices-from-the-structures">
<h2>Generating Graph Matrices from the Structures<a class="headerlink" href="#generating-graph-matrices-from-the-structures" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.kaggle.com/theoviel/generating-graph-matrices-from-the-structures">Referance</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_matrix</span><span class="p">(</span><span class="n">couples</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>  <span class="c1"># neigbouring bases are linked as well</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">couples</span><span class="p">:</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        
    <span class="k">return</span> <span class="n">mat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_couples</span><span class="p">(</span><span class="n">structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For each closing parenthesis, I find the matching opening one and store their index in the couples list.</span>
<span class="sd">    The assigned list is used to keep track of the assigned opening parenthesis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opened</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">]</span>
    <span class="n">closed</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">opened</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">closed</span><span class="p">)</span>


    <span class="n">assigned</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">couples</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">close_idx</span> <span class="ow">in</span> <span class="n">closed</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">open_idx</span> <span class="ow">in</span> <span class="n">opened</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">open_idx</span> <span class="o">&lt;</span> <span class="n">close_idx</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">open_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">assigned</span><span class="p">:</span>
                    <span class="n">candidate</span> <span class="o">=</span> <span class="n">open_idx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">assigned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
        <span class="n">couples</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">candidate</span><span class="p">,</span> <span class="n">close_idx</span><span class="p">])</span>
        
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">couples</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">opened</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">couples</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="abs-difference-between-graph-matrix-and-bpps">
<h2>1. Abs-Difference between Graph Matrix and BPPS<a class="headerlink" href="#abs-difference-between-graph-matrix-and-bpps" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">couples</span> <span class="o">=</span> <span class="n">get_couples</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">build_matrix</span><span class="p">(</span><span class="n">couples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.35</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Graph of the structure&#39;</span><span class="p">)</span>
<span class="c1"># axes[0].pcolormesh(adj_mat, )</span>

<span class="n">bpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span><span class="n">f</span><span class="s2">&quot;/bpps/</span><span class="si">{Select_id}</span><span class="s2">.npy&quot;</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bpp</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BPP Matrix&#39;</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mat</span><span class="o">-</span><span class="n">bpp</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Abs-Difference(mat-bpps) Matrix&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Abs-Difference Value : &quot;</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">mat</span><span class="o">-</span><span class="n">bpp</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/openvaccine-feature-extraction_19_0.png" src="../_images/openvaccine-feature-extraction_19_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Abs-Difference Value :  259.97288937999997
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loop-count">
<h2>2. Loop-Count<a class="headerlink" href="#loop-count" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{len(list(bg.stem_iterator()))} stems&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{len(list(bg.iloop_iterator()))} interior loops&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{len(list(bg.mloop_iterator()))} multiloops&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{len(list(bg.hloop_iterator()))} hairpin loops&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{len(list(bg.floop_iterator()))} fiveprimes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{len(list(bg.tloop_iterator()))} threeprimes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6 stems
3 interior loops
2 multiloops
3 hairpin loops
1 fiveprimes
1 threeprimes
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="iterate-over-all-pairs-of-connected-stems">
<h2>3. Iterate over all pairs of connected stems.<a class="headerlink" href="#iterate-over-all-pairs-of-connected-stems" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">connected_stem_iterator</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;s0&#39;, &#39;m0&#39;, &#39;s2&#39;),
 (&#39;s5&#39;, &#39;m1&#39;, &#39;s2&#39;),
 (&#39;s1&#39;, &#39;i0&#39;, &#39;s0&#39;),
 (&#39;s3&#39;, &#39;i1&#39;, &#39;s2&#39;),
 (&#39;s3&#39;, &#39;i2&#39;, &#39;s4&#39;)]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="elements-present-in-rna">
<h2>4. Elements Present in RNA<a class="headerlink" href="#elements-present-in-rna" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stem_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">stem_iterator</span><span class="p">())</span>
<span class="n">iloop_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">iloop_iterator</span><span class="p">())</span>
<span class="n">mloop_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">mloop_iterator</span><span class="p">())</span>
<span class="n">hloop_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">hloop_iterator</span><span class="p">())</span>
<span class="n">floop_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">floop_iterator</span><span class="p">())</span>
<span class="n">tloop_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">tloop_iterator</span><span class="p">())</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">stem_elements</span> <span class="o">+</span> <span class="n">iloop_elements</span> <span class="o">+</span> <span class="n">mloop_elements</span> <span class="o">+</span> <span class="n">hloop_elements</span> <span class="o">+</span> <span class="n">floop_elements</span> <span class="o">+</span> <span class="n">tloop_elements</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">elements</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;s0&#39;, &#39;s1&#39;, &#39;s2&#39;, &#39;s3&#39;, &#39;s4&#39;, &#39;s5&#39;, &#39;i0&#39;, &#39;i1&#39;, &#39;i2&#39;, &#39;m0&#39;, &#39;m1&#39;, &#39;h0&#39;, &#39;h1&#39;, &#39;h2&#39;, &#39;f0&#39;, &#39;t0&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="element-length-of-each-element">
<h2>5. Element_Length of each element.<a class="headerlink" href="#element-length-of-each-element" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">element_length</span><span class="p">,</span><span class="n">elements</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 8, 4, 4, 12, 14, 1, 10, 4, 1, 4, 7, 4, 4, 5, 21]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-list-containing-the-sequence-s-corresponding-to-the-defines">
<h2>6. A list containing the sequence(s) corresponding to the defines<a class="headerlink" href="#a-list-containing-the-sequence-s-corresponding-to-the-defines" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">get_define_seq_str</span><span class="p">,</span><span class="n">elements</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;AG&#39;, &#39;CU&#39;],
 [&#39;CUCU&#39;, &#39;GGAG&#39;],
 [&#39;GG&#39;, &#39;CC&#39;],
 [&#39;GU&#39;, &#39;AC&#39;],
 [&#39;UUCUAG&#39;, &#39;CUGGAA&#39;],
 [&#39;GUUAGAG&#39;, &#39;CUCUAAC&#39;],
 [&#39;&#39;, &#39;A&#39;],
 [&#39;ACUAC&#39;, &#39;&#39;, &#39;CCAUA&#39;, &#39;&#39;],
 [&#39;AU&#39;, &#39;&#39;, &#39;UA&#39;, &#39;&#39;],
 [&#39;A&#39;],
 [&#39;AGCA&#39;],
 [&#39;AAUAACA&#39;],
 [&#39;GUAA&#39;],
 [&#39;UUCG&#39;],
 [&#39;GGAAA&#39;],
 [&#39;AAAAGAAACAACAACAACAAC&#39;]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-minimum-spanning-tree-from-this-bulgegraph-this-is-useful">
<h2>7. Create a minimum spanning tree from this BulgeGraph. This is useful<a class="headerlink" href="#create-a-minimum-spanning-tree-from-this-bulgegraph-this-is-useful" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">get_mst</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;t0&#39;, &#39;m0&#39;, &#39;s1&#39;, &#39;s0&#39;, &#39;s4&#39;, &#39;m1&#39;, &#39;i0&#39;, &#39;s3&#39;, &#39;s5&#39;, &#39;i2&#39;, &#39;h2&#39;, &#39;h0&#39;, &#39;i1&#39;, &#39;s2&#39;, &#39;h1&#39;, &#39;f0&#39;}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-the-minimum-and-maximum-base-pair-distance-between-2-elements">
<h2>8. Get the minimum and maximum base pair distance between 2 elements<a class="headerlink" href="#get-the-minimum-and-maximum-base-pair-distance-between-2-elements" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="n">bg</span><span class="o">.</span><span class="n">min_max_bp_distance</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span><span class="s1">&#39;s0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0, 6.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">max_sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">e1</span> <span class="ow">in</span> <span class="n">stem_elements</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">iloop_elements</span><span class="p">:</span>
        <span class="n">min_dis</span><span class="p">,</span><span class="n">max_dis</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">min_max_bp_distance</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
        <span class="n">min_sum</span> <span class="o">+=</span> <span class="n">min_dis</span>
        <span class="n">max_sum</span> <span class="o">+=</span> <span class="n">max_dis</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum of Min and Max Distances between stem and iloop elements:&quot;</span><span class="p">,</span><span class="n">min_sum</span><span class="p">,</span><span class="n">max_sum</span><span class="p">)</span>
<span class="n">min_norm_distance</span> <span class="o">=</span> <span class="n">min_sum</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stem_elements</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">iloop_elements</span><span class="p">))</span>
<span class="n">max_norm_distance</span> <span class="o">=</span> <span class="n">max_sum</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stem_elements</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">iloop_elements</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normalised Min and Max Distances between stem and iloop elements:&quot;</span><span class="p">,</span><span class="n">min_norm_distance</span><span class="p">,</span><span class="n">max_norm_distance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum of Min and Max Distances between stem and iloop elements: 116.0 219.0
Normalised Min and Max Distances between stem and iloop elements: 12.88888888888889 24.333333333333332
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">e1</span> <span class="ow">in</span> <span class="n">stem_elements</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">e2</span> <span class="ow">in</span> <span class="n">iloop_elements</span><span class="p">:</span>
        <span class="n">distance</span> <span class="o">+=</span> <span class="n">bg</span><span class="o">.</span><span class="n">ss_distance</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
<span class="n">norm_distance</span> <span class="o">=</span> <span class="n">distance</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stem_elements</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">iloop_elements</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;norm_distance between stem and iloop elements:&quot;</span><span class="p">,</span><span class="n">norm_distance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm_distance between stem and iloop elements: 12.88888888888889
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simple-mfe-prediction-for-a-given-sequence">
<h2>9. Simple MFE prediction for a given sequence<a class="headerlink" href="#simple-mfe-prediction-for-a-given-sequence" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute minimum free energy (MFE) and corresponding structure</span>
<span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">mfe</span><span class="p">)</span> <span class="o">=</span> <span class="n">RNA</span><span class="o">.</span><span class="n">fold</span><span class="p">(</span><span class="n">Sequence</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sequence : &#39;</span><span class="p">,</span><span class="n">Sequence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;structure : &#39;</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFE(Minimum Free energy) : &quot;</span><span class="p">,</span><span class="n">mfe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sequence :  GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUAACUGGAAUAACCCAUACCAGCAGUUAGAGUUCGCUCUAACAAAAGAAACAACAACAACAAC
structure :  .....((((((.......)))).)).((.....((..((((((....))))))..)).....))....(((((((....))))))).....................
MFE(Minimum Free energy) :  -18.899999618530273
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="n">Sequence</span>
<span class="c1"># create fold_compound data structure (required for all subsequently applied  algorithms)</span>
<span class="n">fc</span> <span class="o">=</span> <span class="n">RNA</span><span class="o">.</span><span class="n">fold_compound</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="c1"># compute MFE and MFE structure</span>
<span class="p">(</span><span class="n">mfe_struct</span><span class="p">,</span> <span class="n">mfe</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">mfe</span><span class="p">()</span>
<span class="c1"># rescale Boltzmann factors for partition function computation</span>
<span class="n">fc</span><span class="o">.</span><span class="n">exp_params_rescale</span><span class="p">(</span><span class="n">mfe</span><span class="p">)</span>
<span class="c1"># compute partition function</span>
<span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">pf</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">pf</span><span class="p">()</span>
<span class="c1"># compute centroid structure</span>
<span class="p">(</span><span class="n">centroid_struct</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">centroid</span><span class="p">()</span>
<span class="c1"># compute free energy of centroid structure</span>
<span class="n">centroid_en</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">eval_structure</span><span class="p">(</span><span class="n">centroid_struct</span><span class="p">)</span>
<span class="c1"># compute MEA structure</span>
<span class="p">(</span><span class="n">MEA_struct</span><span class="p">,</span> <span class="n">MEA</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">MEA</span><span class="p">()</span>
<span class="c1"># compute free energy of MEA structure</span>
<span class="n">MEA_en</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">eval_structure</span><span class="p">(</span><span class="n">MEA_struct</span><span class="p">)</span>
<span class="c1"># print everything like RNAfold -p --MEA</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Sequence: &quot;</span><span class="p">,</span><span class="n">Sequence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original structure: &quot;</span><span class="p">,</span><span class="n">structure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;MFE Structure : </span><span class="si">{mfe_struct}</span><span class="s2"> ,</span><span class="se">\n</span><span class="s2">MFE : [</span><span class="si">{mfe}</span><span class="s2">] &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;centroid structure Structure : </span><span class="si">{centroid_struct}</span><span class="s2"> ,</span><span class="se">\n</span><span class="s2">CFE : [</span><span class="si">{centroid_en}</span><span class="s2">] &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;MEA Structure : </span><span class="si">{MEA_struct}</span><span class="s2"> ,</span><span class="se">\n</span><span class="s2">MEA : [</span><span class="si">{MEA_en}</span><span class="s2">] &quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Sequence:  GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUAACUGGAAUAACCCAUACCAGCAGUUAGAGUUCGCUCUAACAAAAGAAACAACAACAACAAC
Original structure:  .....((((((.......)))).)).((.....((..((((((....))))))..)).....))....(((((((....))))))).....................
MFE Structure : .....((((((.......)))).)).((.....((..((((((....))))))..)).....))....(((((((....)))))))..................... ,
MFE : [-18.899999618530273] 
centroid structure Structure : .......((((.......))))..............................................(((((((....)))))))..................... ,
CFE : [-10.399999618530273] 
MEA Structure : .....((((((.......)))).)).((.........((((((....)))))).........))....(((((((....)))))))..................... ,
MEA : [-18.299999237060547] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">bg1</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">mfe_struct</span><span class="p">)</span>
<span class="n">fvm</span><span class="o">.</span><span class="n">plot_rna</span><span class="p">(</span><span class="n">bg1</span><span class="p">,</span> <span class="n">text_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontweight&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">},</span> <span class="n">lighten</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
             <span class="n">backbone_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MFE Structure : &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>


<span class="n">bg2</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">structure</span><span class="p">)</span>
<span class="n">fvm</span><span class="o">.</span><span class="n">plot_rna</span><span class="p">(</span><span class="n">bg2</span><span class="p">,</span> <span class="n">text_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontweight&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">},</span> <span class="n">lighten</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
             <span class="n">backbone_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Structure &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">bg3</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">centroid_struct</span><span class="p">)</span>
<span class="n">fvm</span><span class="o">.</span><span class="n">plot_rna</span><span class="p">(</span><span class="n">bg3</span><span class="p">,</span> <span class="n">text_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontweight&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">},</span> <span class="n">lighten</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
             <span class="n">backbone_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Centroid Structure &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">bg4</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">MEA_struct</span><span class="p">)</span>
<span class="n">fvm</span><span class="o">.</span><span class="n">plot_rna</span><span class="p">(</span><span class="n">bg4</span><span class="p">,</span> <span class="n">text_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontweight&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">},</span> <span class="n">lighten</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
             <span class="n">backbone_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span><span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MEA Structure &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/openvaccine-feature-extraction_39_0.png" src="../_images/openvaccine-feature-extraction_39_0.png" />
</div>
</div>
<div class="section" id="https-www-tbi-univie-ac-at-rna-viennarna-doc-html-helloworld-swig-html-helloworld-python">
<h3><a class="reference external" href="https://www.tbi.univie.ac.at/RNA/ViennaRNA/doc/html/helloworld_swig.html#helloworld_python">https://www.tbi.univie.ac.at/RNA/ViennaRNA/doc/html/helloworld_swig.html#helloworld_python</a><a class="headerlink" href="#https-www-tbi-univie-ac-at-rna-viennarna-doc-html-helloworld-swig-html-helloworld-python" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="loop-type-non-sequencial-probablity">
<h2>Loop-type (Non Sequencial) Probablity<a class="headerlink" href="#loop-type-non-sequencial-probablity" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">loop_count</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">Sequence</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="n">len_</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;seq_length&quot;</span><span class="p">]</span>
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">structure</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">stem_iterator</span><span class="p">()))</span><span class="o">/</span><span class="n">len_</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">iloop_iterator</span><span class="p">()))</span><span class="o">/</span><span class="n">len_</span><span class="p">,</span> 
            <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">mloop_iterator</span><span class="p">()))</span><span class="o">/</span><span class="n">len_</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">hloop_iterator</span><span class="p">()))</span><span class="o">/</span><span class="n">len_</span><span class="p">,</span> 
            <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">floop_iterator</span><span class="p">()))</span><span class="o">/</span><span class="n">len_</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">tloop_iterator</span><span class="p">()))</span><span class="o">/</span><span class="n">len_</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loops_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stems&#39;</span><span class="p">,</span><span class="s1">&#39;interior_loops&#39;</span><span class="p">,</span> <span class="s1">&#39;multiloops&#39;</span><span class="p">,</span> <span class="s1">&#39;hairpin loops&#39;</span><span class="p">,</span> <span class="s1">&#39;fiveprimes&#39;</span><span class="p">,</span><span class="s1">&#39;threeprimes&#39;</span><span class="p">]</span>
<span class="n">train_df</span><span class="p">[</span><span class="n">loops_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">loop_count</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">result_type</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">)</span>
<span class="n">test_df</span><span class="p">[</span><span class="n">loops_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">loop_count</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">result_type</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">)</span>
<span class="n">train_df</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">loops_name</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>stems</th>
      <th>interior_loops</th>
      <th>multiloops</th>
      <th>hairpin loops</th>
      <th>fiveprimes</th>
      <th>threeprimes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id_001f94081</td>
      <td>0.056075</td>
      <td>0.028037</td>
      <td>0.018692</td>
      <td>0.028037</td>
      <td>0.009346</td>
      <td>0.009346</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id_0049f53ba</td>
      <td>0.037383</td>
      <td>0.009346</td>
      <td>0.018692</td>
      <td>0.028037</td>
      <td>0.009346</td>
      <td>0.009346</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id_006f36f57</td>
      <td>0.056075</td>
      <td>0.018692</td>
      <td>0.037383</td>
      <td>0.028037</td>
      <td>0.009346</td>
      <td>0.009346</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id_0082d463b</td>
      <td>0.046729</td>
      <td>0.018692</td>
      <td>0.018692</td>
      <td>0.028037</td>
      <td>0.009346</td>
      <td>0.009346</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id_0087940f4</td>
      <td>0.046729</td>
      <td>0.028037</td>
      <td>0.009346</td>
      <td>0.018692</td>
      <td>0.009346</td>
      <td>0.009346</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Train Data New Features Histograms (Loop-Count)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">_ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">mean_value</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">loops_name</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">max_value_index</span><span class="p">,</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">loops_name</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">train_df</span><span class="p">[</span><span class="n">loops_name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0504aa&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;&#39;</span><span class="si">{loops_name[i]}</span><span class="s2">&#39; Frequency&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span> <span class="n">f</span><span class="s2">&quot;&#39;</span><span class="si">{loops_name[i]}</span><span class="s2">&#39; Histogram&quot;</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean_value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">max_value_index</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span> <span class="s1">&#39;Max&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;Average : </span><span class="si">{mean_value:0.2f}</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">f</span><span class="s2">&quot;Max Frequency : </span><span class="si">{max_value}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Hist&quot;</span><span class="p">],</span> <span class="n">loc</span> <span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/openvaccine-feature-extraction_44_0.png" src="../_images/openvaccine-feature-extraction_44_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Data New Features correlation(Loop Count)</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">loops_name</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;notebook&quot;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lines.linewidth&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Train Data New Features correlation (Loop-Count): &quot;</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span>
<span class="n">rotx</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">roty</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/openvaccine-feature-extraction_45_0.png" src="../_images/openvaccine-feature-extraction_45_0.png" />
</div>
</div>
<ul class="simple">
<li><p>Loop Count Features are not highly correlated so it is good for us</p></li>
</ul>
</div>
<div class="section" id="process-inputs-2-here">
<h2>process_inputs_2 : <a class="reference external" href="https://www.kaggle.com/kank2130/covax-gru-lstm">here</a><a class="headerlink" href="#process-inputs-2-here" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_inputs_2</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df5</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Counter</span> <span class="k">as</span> <span class="n">count</span>
    <span class="n">bases</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)):</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;sequence&#39;</span><span class="p">]))</span>
        <span class="n">bases</span><span class="o">.</span><span class="n">append</span><span class="p">((</span>
            <span class="n">counts</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;seq_length&#39;</span><span class="p">],</span>
            <span class="n">counts</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;seq_length&#39;</span><span class="p">],</span>
            <span class="n">counts</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;seq_length&#39;</span><span class="p">],</span>
            <span class="n">counts</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;seq_length&#39;</span><span class="p">]</span>
        <span class="p">))</span>

    <span class="n">bases</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A_percent&#39;</span><span class="p">,</span> <span class="s1">&#39;G_percent&#39;</span><span class="p">,</span> <span class="s1">&#39;C_percent&#39;</span><span class="p">,</span> <span class="s1">&#39;U_percent&#39;</span><span class="p">])</span>
    <span class="k">del</span> <span class="n">df1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done : [&#39;A_percent&#39;, &#39;G_percent&#39;, &#39;C_percent&#39;, &#39;U_percent&#39;]&quot;</span><span class="p">)</span>
    
    <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_partners</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">)):</span>
        <span class="n">partners</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">130</span><span class="p">)]</span>
        <span class="n">pairs_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;structure&#39;</span><span class="p">])):</span>
            <span class="k">if</span> <span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;structure&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;structure&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pairs_dict</span><span class="p">[(</span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">first</span><span class="p">],</span> <span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">pairs_dict</span><span class="p">[(</span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">first</span><span class="p">],</span> <span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="n">partners</span><span class="p">[</span><span class="n">first</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">partners</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">first</span>

        <span class="n">all_partners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partners</span><span class="p">)</span>

        <span class="n">pairs_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pairs_unique</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pairs_dict</span><span class="p">:</span>
            <span class="n">pairs_num</span> <span class="o">+=</span> <span class="n">pairs_dict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="n">add_tuple</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pairs_unique</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">add_tuple</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pairs_dict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">/</span><span class="n">pairs_num</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">add_tuple</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add_tuple</span><span class="p">)</span>

    <span class="n">pairs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;U-G&#39;</span><span class="p">,</span> <span class="s1">&#39;C-G&#39;</span><span class="p">,</span> <span class="s1">&#39;U-A&#39;</span><span class="p">,</span> <span class="s1">&#39;G-C&#39;</span><span class="p">,</span> <span class="s1">&#39;A-U&#39;</span><span class="p">,</span> <span class="s1">&#39;G-U&#39;</span><span class="p">])</span>
    <span class="k">del</span> <span class="n">df2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done : [&#39;U-G&#39;, &#39;C-G&#39;, &#39;U-A&#39;, &#39;G-C&#39;, &#39;A-U&#39;, &#39;G-U&#39;]&quot;</span><span class="p">)</span>
    
    <span class="n">pairs_rate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df3</span><span class="p">)):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;structure&#39;</span><span class="p">]))</span>
        <span class="n">pairs_rate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;(&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;seq_length&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">pairs_rate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pairs_rate</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pairs_rate&#39;</span><span class="p">])</span>
    <span class="k">del</span> <span class="n">df3</span>
    
    <span class="n">loops</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df4</span><span class="p">)):</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;predicted_loop_type&#39;</span><span class="p">]))</span>
        <span class="n">available</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">/</span> <span class="n">df4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;seq_length&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">loops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="n">loops</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">loops</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">available</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">df4</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done : [&#39;E&#39;, &#39;S&#39;, &#39;H&#39;, &#39;B&#39;, &#39;X&#39;, &#39;I&#39;, &#39;M&#39;]&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df5</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">pairs</span><span class="p">,</span> <span class="n">loops</span><span class="p">,</span> <span class="n">pairs_rate</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [&#39;A_percent&#39;, &#39;G_percent&#39;, &#39;C_percent&#39;, &#39;U_percent&#39;]</span>
<span class="c1"># [&#39;U-G&#39;, &#39;C-G&#39;, &#39;U-A&#39;, &#39;G-C&#39;, &#39;A-U&#39;, &#39;G-U&#39;]</span>
<span class="c1"># [&#39;pairs_rate&#39;]</span>
<span class="c1"># [&#39;E&#39;, &#39;S&#39;, &#39;H&#39;, &#39;B&#39;, &#39;X&#39;, &#39;I&#39;, &#39;M&#39;]</span>

<span class="n">train_df</span> <span class="o">=</span> <span class="n">process_inputs_2</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Done : [&#39;A_percent&#39;, &#39;G_percent&#39;, &#39;C_percent&#39;, &#39;U_percent&#39;]
Done : [&#39;U-G&#39;, &#39;C-G&#39;, &#39;U-A&#39;, &#39;G-C&#39;, &#39;A-U&#39;, &#39;G-U&#39;]
Done : [&#39;E&#39;, &#39;S&#39;, &#39;H&#39;, &#39;B&#39;, &#39;X&#39;, &#39;I&#39;, &#39;M&#39;]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>sequence</th>
      <th>structure</th>
      <th>predicted_loop_type</th>
      <th>signal_to_noise</th>
      <th>SN_filter</th>
      <th>seq_length</th>
      <th>seq_scored</th>
      <th>reactivity_error</th>
      <th>...</th>
      <th>A-U</th>
      <th>G-U</th>
      <th>E</th>
      <th>S</th>
      <th>H</th>
      <th>B</th>
      <th>X</th>
      <th>I</th>
      <th>M</th>
      <th>pairs_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id_001f94081</td>
      <td>GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUA...</td>
      <td>.....((((((.......)))).)).((.....((..((((((......</td>
      <td>EEEEESSSSSSHHHHHHHSSSSBSSXSSIIIIISSIISSSSSSHHH...</td>
      <td>6.894</td>
      <td>1</td>
      <td>107</td>
      <td>68</td>
      <td>[0.1359, 0.20700000000000002, 0.1633, 0.1452, ...</td>
      <td>...</td>
      <td>0.173913</td>
      <td>0.000000</td>
      <td>0.242991</td>
      <td>0.429907</td>
      <td>0.140187</td>
      <td>0.009346</td>
      <td>0.046729</td>
      <td>0.130841</td>
      <td>0.000000</td>
      <td>0.429907</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id_0049f53ba</td>
      <td>GGAAAAAGCGCGCGCGGUUAGCGCGCGCUUUUGCGCGCGCUGUACC...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>EEEEESSSSSSSSSSSSSSSSSSSSSSSHHHHSSSSSSSSSSBSSS...</td>
      <td>0.193</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[2.8272, 2.8272, 2.8272, 4.7343, 2.5676, 2.567...</td>
      <td>...</td>
      <td>0.121212</td>
      <td>0.060606</td>
      <td>0.242991</td>
      <td>0.616822</td>
      <td>0.102804</td>
      <td>0.009346</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.028037</td>
      <td>0.616822</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id_006f36f57</td>
      <td>GGAAAGUGCUCAGAUAAGCUAAGCUCGAAUAGCAAUCGAAUAGAAU...</td>
      <td>.....((((.((.....((((.(((.....)))..((((......)...</td>
      <td>EEEEESSSSISSIIIIISSSSMSSSHHHHHSSSMMSSSSHHHHHHS...</td>
      <td>8.800</td>
      <td>1</td>
      <td>107</td>
      <td>68</td>
      <td>[0.0931, 0.13290000000000002, 0.11280000000000...</td>
      <td>...</td>
      <td>0.125000</td>
      <td>0.125000</td>
      <td>0.242991</td>
      <td>0.448598</td>
      <td>0.140187</td>
      <td>0.000000</td>
      <td>0.009346</td>
      <td>0.112150</td>
      <td>0.046729</td>
      <td>0.448598</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id_0082d463b</td>
      <td>GGAAAAGCGCGCGCGCGCGCGCGAAAAAGCGCGCGCGCGCGCGCGC...</td>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
      <td>EEEEEESSSSSSSSSSSSSSSSHHHHHHSSSSSSSSSSSSSSSSSS...</td>
      <td>0.104</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[3.5229, 6.0748, 3.0374, 3.0374, 3.0374, 3.037...</td>
      <td>...</td>
      <td>0.031250</td>
      <td>0.062500</td>
      <td>0.252336</td>
      <td>0.598131</td>
      <td>0.130841</td>
      <td>0.018692</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.598131</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id_0087940f4</td>
      <td>GGAAAAUAUAUAAUAUAUUAUAUAAAUAUAUUAUAGAAGUAUAAUA...</td>
      <td>.....(((((((.((((((((((((.(((((((((....)))))))...</td>
      <td>EEEEESSSSSSSBSSSSSSSSSSSSBSSSSSSSSSHHHHSSSSSSS...</td>
      <td>0.423</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[1.665, 2.1728, 2.0041, 1.2405, 0.620200000000...</td>
      <td>...</td>
      <td>0.542857</td>
      <td>0.000000</td>
      <td>0.242991</td>
      <td>0.654206</td>
      <td>0.074766</td>
      <td>0.028037</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.654206</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 43 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">process_inputs_2</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Done : [&#39;A_percent&#39;, &#39;G_percent&#39;, &#39;C_percent&#39;, &#39;U_percent&#39;]
Done : [&#39;U-G&#39;, &#39;C-G&#39;, &#39;U-A&#39;, &#39;G-C&#39;, &#39;A-U&#39;, &#39;G-U&#39;]
Done : [&#39;E&#39;, &#39;S&#39;, &#39;H&#39;, &#39;B&#39;, &#39;X&#39;, &#39;I&#39;, &#39;M&#39;]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>sequence</th>
      <th>structure</th>
      <th>predicted_loop_type</th>
      <th>seq_length</th>
      <th>seq_scored</th>
      <th>stems</th>
      <th>interior_loops</th>
      <th>multiloops</th>
      <th>...</th>
      <th>A-U</th>
      <th>G-U</th>
      <th>E</th>
      <th>S</th>
      <th>H</th>
      <th>B</th>
      <th>X</th>
      <th>I</th>
      <th>M</th>
      <th>pairs_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id_00073f8be</td>
      <td>GGAAAAGUACGACUUGAGUACGGAAAACGUACCAACUCGAUUAAAA...</td>
      <td>......((((((((((.(((((.....))))))))((((((((......</td>
      <td>EEEEEESSSSSSSSSSBSSSSSHHHHHSSSSSSSSSSSSSSSSHHH...</td>
      <td>107</td>
      <td>68</td>
      <td>0.065421</td>
      <td>0.028037</td>
      <td>0.037383</td>
      <td>...</td>
      <td>0.233333</td>
      <td>0.033333</td>
      <td>0.252336</td>
      <td>0.560748</td>
      <td>0.112150</td>
      <td>0.065421</td>
      <td>0.009346</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.560748</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id_000ae4237</td>
      <td>GGAAACGGGUUCCGCGGAUUGCUGCUAAUAAGAGUAAUCUCUAAAU...</td>
      <td>.....((((..((((((...(((((.....((((....)))).......</td>
      <td>EEEEESSSSIISSSSSSIIISSSSSIIIIISSSSHHHHSSSSIIII...</td>
      <td>130</td>
      <td>91</td>
      <td>0.053846</td>
      <td>0.023077</td>
      <td>0.030769</td>
      <td>...</td>
      <td>0.100000</td>
      <td>0.000000</td>
      <td>0.200000</td>
      <td>0.461538</td>
      <td>0.107692</td>
      <td>0.000000</td>
      <td>0.030769</td>
      <td>0.161538</td>
      <td>0.038462</td>
      <td>0.461538</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id_00131c573</td>
      <td>GGAAAACAAAACGGCCUGGAAGACGAAGGAAUUCGGCGCGAAGGCC...</td>
      <td>...........((.(((.(.(..((..((..((((...))))..))...</td>
      <td>EEEEEEEEEEESSISSSISISIISSIISSIISSSSHHHSSSSIISS...</td>
      <td>107</td>
      <td>68</td>
      <td>0.074766</td>
      <td>0.056075</td>
      <td>0.009346</td>
      <td>...</td>
      <td>0.136364</td>
      <td>0.000000</td>
      <td>0.299065</td>
      <td>0.411215</td>
      <td>0.065421</td>
      <td>0.000000</td>
      <td>0.056075</td>
      <td>0.168224</td>
      <td>0.000000</td>
      <td>0.411215</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id_00181fd34</td>
      <td>GGAAAGGAUCUCUAUCGAAGGAUAGAGAUCGCUCGCGACGGCACGA...</td>
      <td>......((((((((((....))))))))))((((((..((.(((.....</td>
      <td>EEEEEESSSSSSSSSSHHHHSSSSSSSSSSSSSSSSIISSISSSHH...</td>
      <td>107</td>
      <td>68</td>
      <td>0.046729</td>
      <td>0.018692</td>
      <td>0.018692</td>
      <td>...</td>
      <td>0.178571</td>
      <td>0.035714</td>
      <td>0.252336</td>
      <td>0.523364</td>
      <td>0.112150</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.056075</td>
      <td>0.056075</td>
      <td>0.523364</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id_0020473f7</td>
      <td>GGAAACCCGCCCGCGCCCGCCCGCGCUGCUGCCGUGCCUCCUCUCC...</td>
      <td>.....(((((((((((((((((((((((((((((((((((((((((...</td>
      <td>EEEEESSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS...</td>
      <td>130</td>
      <td>91</td>
      <td>0.015385</td>
      <td>0.000000</td>
      <td>0.007692</td>
      <td>...</td>
      <td>0.041667</td>
      <td>0.208333</td>
      <td>0.200000</td>
      <td>0.738462</td>
      <td>0.061538</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.738462</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A_percent&#39;</span><span class="p">,</span><span class="s1">&#39;G_percent&#39;</span><span class="p">,</span> <span class="s1">&#39;C_percent&#39;</span><span class="p">,</span> <span class="s1">&#39;U_percent&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;U-G&#39;</span><span class="p">,</span> <span class="s1">&#39;C-G&#39;</span><span class="p">,</span> <span class="s1">&#39;U-A&#39;</span><span class="p">,</span> <span class="s1">&#39;G-C&#39;</span><span class="p">,</span><span class="s1">&#39;A-U&#39;</span><span class="p">,</span> <span class="s1">&#39;G-U&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;pairs_rate&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">loops_name</span>

<span class="k">def</span> <span class="nf">add_axis</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">s_len</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">val</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">s_len</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ns_columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">train_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[[</span><span class="n">c</span><span class="p">,</span><span class="s2">&quot;seq_length&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">add_axis</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[[</span><span class="n">c</span><span class="p">,</span><span class="s2">&quot;seq_length&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">add_axis</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_percent
G_percent
C_percent
U_percent
U-G
C-G
U-A
G-C
A-U
G-U
E
S
H
B
X
I
M
pairs_rate
stems
interior_loops
multiloops
hairpin loops
fiveprimes
threeprimes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="p">[</span><span class="n">ns_columns</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A_percent</th>
      <th>G_percent</th>
      <th>C_percent</th>
      <th>U_percent</th>
      <th>U-G</th>
      <th>C-G</th>
      <th>U-A</th>
      <th>G-C</th>
      <th>A-U</th>
      <th>G-U</th>
      <th>...</th>
      <th>X</th>
      <th>I</th>
      <th>M</th>
      <th>pairs_rate</th>
      <th>stems</th>
      <th>interior_loops</th>
      <th>multiloops</th>
      <th>hairpin loops</th>
      <th>fiveprimes</th>
      <th>threeprimes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[0.4205607476635514, 0.4205607476635514, 0.420...</td>
      <td>[0.17757009345794392, 0.17757009345794392, 0.1...</td>
      <td>[0.21495327102803738, 0.21495327102803738, 0.2...</td>
      <td>[0.18691588785046728, 0.18691588785046728, 0.1...</td>
      <td>[0.08695652173913043, 0.08695652173913043, 0.0...</td>
      <td>[0.13043478260869565, 0.13043478260869565, 0.1...</td>
      <td>[0.2608695652173913, 0.2608695652173913, 0.260...</td>
      <td>[0.34782608695652173, 0.34782608695652173, 0.3...</td>
      <td>[0.17391304347826086, 0.17391304347826086, 0.1...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>...</td>
      <td>[0.04672897196261682, 0.04672897196261682, 0.0...</td>
      <td>[0.1308411214953271, 0.1308411214953271, 0.130...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.42990654205607476, 0.42990654205607476, 0.4...</td>
      <td>[0.056074766355140186, 0.056074766355140186, 0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[0.2336448598130841, 0.2336448598130841, 0.233...</td>
      <td>[0.308411214953271, 0.308411214953271, 0.30841...</td>
      <td>[0.29906542056074764, 0.29906542056074764, 0.2...</td>
      <td>[0.1588785046728972, 0.1588785046728972, 0.158...</td>
      <td>[0.030303030303030304, 0.030303030303030304, 0...</td>
      <td>[0.36363636363636365, 0.36363636363636365, 0.3...</td>
      <td>[0.030303030303030304, 0.030303030303030304, 0...</td>
      <td>[0.3939393939393939, 0.3939393939393939, 0.393...</td>
      <td>[0.12121212121212122, 0.12121212121212122, 0.1...</td>
      <td>[0.06060606060606061, 0.06060606060606061, 0.0...</td>
      <td>...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.616822429906542, 0.616822429906542, 0.61682...</td>
      <td>[0.037383177570093455, 0.037383177570093455, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[0.40186915887850466, 0.40186915887850466, 0.4...</td>
      <td>[0.22429906542056074, 0.22429906542056074, 0.2...</td>
      <td>[0.18691588785046728, 0.18691588785046728, 0.1...</td>
      <td>[0.18691588785046728, 0.18691588785046728, 0.1...</td>
      <td>[0.041666666666666664, 0.041666666666666664, 0...</td>
      <td>[0.20833333333333334, 0.20833333333333334, 0.2...</td>
      <td>[0.20833333333333334, 0.20833333333333334, 0.2...</td>
      <td>[0.2916666666666667, 0.2916666666666667, 0.291...</td>
      <td>[0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.1...</td>
      <td>[0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.1...</td>
      <td>...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.11214953271028037, 0.11214953271028037, 0.1...</td>
      <td>[0.04672897196261682, 0.04672897196261682, 0.0...</td>
      <td>[0.4485981308411215, 0.4485981308411215, 0.448...</td>
      <td>[0.056074766355140186, 0.056074766355140186, 0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.037383177570093455, 0.037383177570093455, 0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[0.2616822429906542, 0.2616822429906542, 0.261...</td>
      <td>[0.32710280373831774, 0.32710280373831774, 0.3...</td>
      <td>[0.32710280373831774, 0.32710280373831774, 0.3...</td>
      <td>[0.08411214953271028, 0.08411214953271028, 0.0...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.4375, 0.4375, 0.4375, 0.4375, 0.4375, 0.437...</td>
      <td>[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.062...</td>
      <td>[0.40625, 0.40625, 0.40625, 0.40625, 0.40625, ...</td>
      <td>[0.03125, 0.03125, 0.03125, 0.03125, 0.03125, ...</td>
      <td>[0.0625, 0.0625, 0.0625, 0.0625, 0.0625, 0.062...</td>
      <td>...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.5981308411214953, 0.5981308411214953, 0.598...</td>
      <td>[0.04672897196261682, 0.04672897196261682, 0.0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[0.5420560747663551, 0.5420560747663551, 0.542...</td>
      <td>[0.056074766355140186, 0.056074766355140186, 0...</td>
      <td>[0.056074766355140186, 0.056074766355140186, 0...</td>
      <td>[0.34579439252336447, 0.34579439252336447, 0.3...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.45714285714285713, 0.45714285714285713, 0.4...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.5428571428571428, 0.5428571428571428, 0.542...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.6542056074766355, 0.6542056074766355, 0.654...</td>
      <td>[0.04672897196261682, 0.04672897196261682, 0.0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="sequencial-feature-generation">
<h2>Sequencial Feature Generation<a class="headerlink" href="#sequencial-feature-generation" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="implementing-sliding-window-features">
<h2>Implementing Sliding Window Features<a class="headerlink" href="#implementing-sliding-window-features" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seq_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">,</span><span class="s1">&#39;structure&#39;</span><span class="p">,</span><span class="s1">&#39;predicted_loop_type&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sliding-window-pair-features">
<h3>Sliding Window Pair Features<a class="headerlink" href="#sliding-window-pair-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pair_feature</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">its</span> <span class="o">=</span> <span class="p">[</span><span class="nb">iter</span><span class="p">([</span><span class="s1">&#39;_&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">arr</span><span class="p">[:])</span> <span class="p">,</span><span class="nb">iter</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">])]</span>
    <span class="n">list_touple</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">its</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span><span class="n">list_touple</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sequence: &quot;</span><span class="p">,</span><span class="n">Sequence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pair_feature len: &quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pair_feature</span><span class="p">(</span><span class="n">Sequence</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pair_feature : &quot;</span><span class="p">,(</span><span class="n">pair_feature</span><span class="p">(</span><span class="n">Sequence</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sequence:  GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUAACUGGAAUAACCCAUACCAGCAGUUAGAGUUCGCUCUAACAAAAGAAACAACAACAACAAC
pair_feature len:  107
pair_feature :  [&#39;_G&#39;, &#39;GA&#39;, &#39;GA&#39;, &#39;AA&#39;, &#39;AA&#39;, &#39;AG&#39;, &#39;AC&#39;, &#39;GU&#39;, &#39;CC&#39;, &#39;UU&#39;, &#39;CA&#39;, &#39;UA&#39;, &#39;AU&#39;, &#39;AA&#39;, &#39;UA&#39;, &#39;AC&#39;, &#39;AA&#39;, &#39;CG&#39;, &#39;AG&#39;, &#39;GA&#39;, &#39;GG&#39;, &#39;AA&#39;, &#39;GC&#39;, &#39;AU&#39;, &#39;CA&#39;, &#39;UG&#39;, &#39;AG&#39;, &#39;GA&#39;, &#39;GC&#39;, &#39;AU&#39;, &#39;CA&#39;, &#39;UC&#39;, &#39;AG&#39;, &#39;CU&#39;, &#39;GA&#39;, &#39;UU&#39;, &#39;AU&#39;, &#39;UU&#39;, &#39;UC&#39;, &#39;UU&#39;, &#39;CA&#39;, &#39;UG&#39;, &#39;AG&#39;, &#39;GU&#39;, &#39;GA&#39;, &#39;UA&#39;, &#39;AC&#39;, &#39;AU&#39;, &#39;CG&#39;, &#39;UG&#39;, &#39;GA&#39;, &#39;GA&#39;, &#39;AU&#39;, &#39;AA&#39;, &#39;UA&#39;, &#39;AC&#39;, &#39;AC&#39;, &#39;CC&#39;, &#39;CA&#39;, &#39;CU&#39;, &#39;AA&#39;, &#39;UC&#39;, &#39;AC&#39;, &#39;CA&#39;, &#39;CG&#39;, &#39;AC&#39;, &#39;GA&#39;, &#39;CG&#39;, &#39;AU&#39;, &#39;GU&#39;, &#39;UA&#39;, &#39;UG&#39;, &#39;AA&#39;, &#39;GG&#39;, &#39;AU&#39;, &#39;GU&#39;, &#39;UC&#39;, &#39;UG&#39;, &#39;CC&#39;, &#39;GU&#39;, &#39;CC&#39;, &#39;UU&#39;, &#39;CA&#39;, &#39;UA&#39;, &#39;AC&#39;, &#39;AA&#39;, &#39;CA&#39;, &#39;AA&#39;, &#39;AA&#39;, &#39;AG&#39;, &#39;AA&#39;, &#39;GA&#39;, &#39;AA&#39;, &#39;AC&#39;, &#39;AA&#39;, &#39;CA&#39;, &#39;AC&#39;, &#39;AA&#39;, &#39;CA&#39;, &#39;AC&#39;, &#39;AA&#39;, &#39;CA&#39;, &#39;AC&#39;, &#39;AA&#39;, &#39;CA&#39;, &#39;AC&#39;, &#39;A_&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for col in seq_features:</span>
<span class="c1">#     train_df[&#39;pair_AB_&#39;+col] = train_df[col].apply(pair_feature)</span>
<span class="c1">#     test_df[&#39;pair_AB_&#39;+col] = test_df[col].apply(pair_feature)</span>
<span class="c1"># train_df[seq_features].head()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="compute-mfe-mea-centroid-structure">
<h2>Compute MFE,MEA ,Centroid Structure<a class="headerlink" href="#compute-mfe-mea-centroid-structure" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_structure</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="c1"># create fold_compound data structure (required for all subsequently applied  algorithms)</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="n">RNA</span><span class="o">.</span><span class="n">fold_compound</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="c1"># compute MFE and MFE structure</span>
    <span class="p">(</span><span class="n">mfe_struct</span><span class="p">,</span> <span class="n">mfe</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">mfe</span><span class="p">()</span>
    <span class="c1"># rescale Boltzmann factors for partition function computation</span>
    <span class="n">fc</span><span class="o">.</span><span class="n">exp_params_rescale</span><span class="p">(</span><span class="n">mfe</span><span class="p">)</span>
    <span class="c1"># compute partition function</span>
    <span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">pf</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">pf</span><span class="p">()</span>
    <span class="c1"># compute centroid structure</span>
    <span class="p">(</span><span class="n">centroid_struct</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">centroid</span><span class="p">()</span>
    <span class="c1"># compute MEA structure</span>
    <span class="p">(</span><span class="n">MEA_struct</span><span class="p">,</span> <span class="n">MEA</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">MEA</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">mfe_struct</span><span class="p">,</span><span class="n">centroid_struct</span><span class="p">,</span><span class="n">MEA_struct</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">id_</span><span class="p">,</span><span class="n">se</span><span class="p">,</span><span class="n">st</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">]):</span>
    <span class="n">mfe_struct</span><span class="p">,</span><span class="n">centroid_struct</span><span class="p">,</span><span class="n">MEA_struct</span> <span class="o">=</span> <span class="n">compute_structure</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mfe_structure&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">mfe_struct</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;centroid_structure&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">centroid_struct</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;MEA_structure&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">MEA_struct</span>
    
<span class="k">for</span> <span class="p">(</span><span class="n">id_</span><span class="p">,</span><span class="n">se</span><span class="p">,</span><span class="n">st</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">],</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">]):</span>
    <span class="n">mfe_struct</span><span class="p">,</span><span class="n">centroid_struct</span><span class="p">,</span><span class="n">MEA_struct</span> <span class="o">=</span> <span class="n">compute_structure</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mfe_structure&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">mfe_struct</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;centroid_structure&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">centroid_struct</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;MEA_structure&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">MEA_struct</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="p">[[</span><span class="s1">&#39;structure&#39;</span><span class="p">,</span><span class="s1">&#39;mfe_structure&#39;</span><span class="p">,</span><span class="s1">&#39;centroid_structure&#39;</span><span class="p">,</span><span class="s1">&#39;MEA_structure&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>structure</th>
      <th>mfe_structure</th>
      <th>centroid_structure</th>
      <th>MEA_structure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>.....((((((.......)))).)).((.....((..((((((......</td>
      <td>.....((((((.......)))).)).((.....((..((((((......</td>
      <td>.......((((.......))))...........................</td>
      <td>.....((((((.......)))).)).((.........((((((......</td>
    </tr>
    <tr>
      <th>1</th>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>.....((((.((.....((((.(((.....)))..((((......)...</td>
      <td>.....((((.((.....((((.(((.....)))..((((......)...</td>
      <td>...................................((((......)...</td>
      <td>.......((...(.....)...))...........((((......)...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
      <td>......((((((((((((((((......)))))))))))))))).....</td>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>.....(((((((.((((((((((((.(((((((((....)))))))...</td>
      <td>.....(((((((.((((((((((((.(((((((((....)))))))...</td>
      <td>......(((((..(((((((((((.((((((((((....)))))))...</td>
      <td>.....((((((.((((((((((((.((((((((((....)))))))...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="loop-typefeaure-generation-mfe-mea-centroid-structure">
<h2>Loop TypeFeaure Generation (MFE,MEA ,Centroid Structure)<a class="headerlink" href="#loop-typefeaure-generation-mfe-mea-centroid-structure" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">structure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predicted_loop_type</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;fffffsssssshhhhhhhssssissmssiiiiissiisssssshhhhssssssiissiiiiissmmmmssssssshhhhsssssssttttttttttttttttttttt&#39;, &#39;00000001111000000011110000221111133224444441111444444223311111221111555555522225555555000000000000000000000&#39;]
EEEEESSSSSSHHHHHHHSSSSBSSXSSIIIIISSIISSSSSSHHHHSSSSSSIISSIIIIISSXXXXSSSSSSSHHHHSSSSSSSEEEEEEEEEEEEEEEEEEEEE
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_element_string</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    
    <span class="n">Sequence</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Sequence</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">structure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">#  |   Create a string similar to dotbracket notation that identifies what</span>
<span class="c1">#  |      type of element is present at each location.</span>
<span class="c1">#  |      </span>
<span class="c1">#  |      For example the following dotbracket:</span>
<span class="c1">#  |      </span>
<span class="c1">#  |      ..((..))..</span>
<span class="c1">#  |      </span>
<span class="c1">#  |      Should yield the following element string:</span>
<span class="c1">#  |      </span>
<span class="c1">#  |      ffsshhsstt</span>
<span class="c1">#  |      </span>
<span class="c1">#  |      Indicating that it begins with a fiveprime region, continues with a</span>
<span class="c1">#  |      stem, has a hairpin after the stem, the stem continues and it is terminated</span>
<span class="c1">#  |      by a threeprime region.</span>
<span class="c1">#  |      </span>
<span class="c1">#  |      :param with_numbers: show the last digit of the element id in a second line.::</span>
<span class="c1">#  |      </span>
<span class="c1">#  |                               (((.(((...))))))</span>
<span class="c1">#  |      </span>
<span class="c1">#  |                           Could result in::</span>
<span class="c1">#  |      </span>
<span class="c1">#  |                               sssissshhhssssss</span>
<span class="c1">#  |                               0000111000111000</span>
<span class="c1">#  |      </span>
<span class="c1">#  |                           Indicating that the first stem is named &#39;s0&#39;, followed by &#39;i0&#39;,&#39;</span>
<span class="c1">#  |                           s1&#39;, &#39;h0&#39;, the second strand of &#39;s1&#39; and the second strand of &#39;s0&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train_df[[&#39;LP_type_value&#39;,&#39;LP_type_index&#39;]] = train_df.apply(create_element_string, axis=1,result_type=&quot;expand&quot;).head()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="alternate-method">
<h3>Alternate Method<a class="headerlink" href="#alternate-method" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">id_</span><span class="p">,</span><span class="n">se</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">mfe</span><span class="p">,</span><span class="n">cent</span><span class="p">,</span><span class="n">mea</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">],</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;mfe_structure&#39;</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;centroid_structure&#39;</span><span class="p">],</span> <span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;MEA_structure&#39;</span><span class="p">]):</span>
    
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">se</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">mfe</span><span class="p">)</span>
    <span class="n">LP_type_value</span><span class="p">,</span><span class="n">LP_type_index</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mfe_predicted_loop_type&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_value</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mfe_predicted_loop_type_inxex&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_index</span>
    
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">se</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">cent</span><span class="p">)</span>
    <span class="n">LP_type_value</span><span class="p">,</span><span class="n">LP_type_index</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_value</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type_inxex&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_index</span>
    
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">se</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">mea</span><span class="p">)</span>
    <span class="n">LP_type_value</span><span class="p">,</span><span class="n">LP_type_index</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_value</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type_inxex&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_index</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="p">[[</span><span class="s1">&#39;mfe_predicted_loop_type&#39;</span><span class="p">,</span><span class="s1">&#39;mfe_predicted_loop_type_inxex&#39;</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type&#39;</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type_inxex&#39;</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type&#39;</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type_inxex&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mfe_predicted_loop_type</th>
      <th>mfe_predicted_loop_type_inxex</th>
      <th>centroid_predicted_loop_type</th>
      <th>centroid_predicted_loop_type_inxex</th>
      <th>mea_predicted_loop_type</th>
      <th>mea_predicted_loop_type_inxex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2395</th>
      <td>ffffffffssiisshhhhhhssiiissmmmmmmmmmssshhhhhhh...</td>
      <td>0000000000001100000011000000000000002221111111...</td>
      <td>ffffffffffffffffffffffffffffffffffffssshhhhhhh...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>fffffffffffffshhhhhhsmmmmsshhhhssmmmssshhhhhhh...</td>
      <td>0000000000000000000000000111111111112222222222...</td>
    </tr>
    <tr>
      <th>2396</th>
      <td>ffffffffffffffffffffffffffffffffffffffffffffff...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>ffffffffffffffffffffffffffffffffffffffffffffff...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>ffffffffffffffffffffffffffffffffffffffffffffff...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>2397</th>
      <td>fffffssssssssssssshhhhssssssssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000011111111111...</td>
      <td>fffffssssssssssssshhhhssssssssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000011111111111...</td>
      <td>fffffssssssssssssshhhhssssssssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000011111111111...</td>
    </tr>
    <tr>
      <th>2398</th>
      <td>fffffssssiishhhhsiissssmmmmmmssshhhhsssmmmmmmm...</td>
      <td>0000000000010000100000000000022211112221111111...</td>
      <td>fffffssssiishhhhsiissssmmmmmmssshhhhsssmmmmmmm...</td>
      <td>0000000000010000100000000000022211112221111111...</td>
      <td>fffffssssiishhhhsiissssmmmmmmssshhhhsssmmmmmmm...</td>
      <td>0000000000010000100000000000022211112221111111...</td>
    </tr>
    <tr>
      <th>2399</th>
      <td>fffffsssssssssssssssshhhssssissssmsssssssssshh...</td>
      <td>0000000000111222233330003333022221444555555511...</td>
      <td>fffffsssssssssssssssshhhssssissssmsssssssssshh...</td>
      <td>0000000000111222233330003333022221444555555511...</td>
      <td>fffffsssssssssssssssshhhssssissssmsssssssssshh...</td>
      <td>0000000000111222233330003333022221444555555511...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">id_</span><span class="p">,</span><span class="n">se</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">mfe</span><span class="p">,</span><span class="n">cent</span><span class="p">,</span><span class="n">mea</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">],</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">],</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;mfe_structure&#39;</span><span class="p">],</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;centroid_structure&#39;</span><span class="p">],</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;MEA_structure&#39;</span><span class="p">]):</span>
    
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">se</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">mfe</span><span class="p">)</span>
    <span class="n">LP_type_value</span><span class="p">,</span><span class="n">LP_type_index</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mfe_predicted_loop_type&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_value</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mfe_predicted_loop_type_inxex&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_index</span>
    
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">se</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">cent</span><span class="p">)</span>
    <span class="n">LP_type_value</span><span class="p">,</span><span class="n">LP_type_index</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_value</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type_inxex&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_index</span>
    
    <span class="n">bg</span><span class="p">,</span> <span class="o">=</span> <span class="n">bulge_graph</span><span class="o">.</span><span class="n">BulgeGraph</span><span class="o">.</span><span class="n">from_fasta_text</span><span class="p">(</span><span class="s1">&#39;&gt;seq</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">se</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">mea</span><span class="p">)</span>
    <span class="n">LP_type_value</span><span class="p">,</span><span class="n">LP_type_index</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">to_element_string</span><span class="p">(</span><span class="n">with_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_value</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type_inxex&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">LP_type_index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span><span class="p">[[</span><span class="s1">&#39;mfe_predicted_loop_type&#39;</span><span class="p">,</span><span class="s1">&#39;mfe_predicted_loop_type_inxex&#39;</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type&#39;</span><span class="p">,</span><span class="s1">&#39;centroid_predicted_loop_type_inxex&#39;</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type&#39;</span><span class="p">,</span><span class="s1">&#39;mea_predicted_loop_type_inxex&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mfe_predicted_loop_type</th>
      <th>mfe_predicted_loop_type_inxex</th>
      <th>centroid_predicted_loop_type</th>
      <th>centroid_predicted_loop_type_inxex</th>
      <th>mea_predicted_loop_type</th>
      <th>mea_predicted_loop_type_inxex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3629</th>
      <td>ffffffffssssssssssssssiiisssssshhhhhhssssssiii...</td>
      <td>0000000000000000112222000333333000000333333000...</td>
      <td>ffffffffssssssssssssssiiisssssshhhhhhssssssiii...</td>
      <td>0000000000000000112222000333333000000333333000...</td>
      <td>ffffffffssssssssssssssiiisssssshhhhhhssssssiii...</td>
      <td>0000000000000000112222000333333000000333333000...</td>
    </tr>
    <tr>
      <th>3630</th>
      <td>fffffffsssssmmmssshhhhhhhhhhsssmmmmmmmssshhhhh...</td>
      <td>0000000000000001110000000000111111111122211111...</td>
      <td>fffffffsssssmmmssshhhhhhhhhhsssmmmmmmmssshhhhh...</td>
      <td>0000000000000001110000000000111111111122211111...</td>
      <td>fffffffsssssmmmssshhhhhhhhhhsssmmmmmmmssshhhhh...</td>
      <td>0000000000000001110000000000111111111122211111...</td>
    </tr>
    <tr>
      <th>3631</th>
      <td>fffffssssssshhhhssssssssssisssssssssssssssssss...</td>
      <td>0000000000000000000000011102222222333333333333...</td>
      <td>fffffssssssshhhhssssssssssisssssssssssssssssss...</td>
      <td>0000000000000000000000011102222222333333333333...</td>
      <td>fffffssssssshhhhssssssssssisssssssssssssssssss...</td>
      <td>0000000000000000000000011102222222333333333333...</td>
    </tr>
    <tr>
      <th>3632</th>
      <td>fffffffsissssisshhhhhhssissssisssssssiiiiiiiii...</td>
      <td>0000000001111122000000221111100333333222222222...</td>
      <td>fffffffffffffffffffffffffffffffssssssiiiiiiiii...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>fffffffffffffffffffffffffffffffssssssiiiiiiiii...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
    </tr>
    <tr>
      <th>3633</th>
      <td>fffffffsssiissssiiiisssssisssssssiiissiisssssh...</td>
      <td>0000000000001111111122222233333333334444555550...</td>
      <td>fffffffsssiissssiiiisssssisssssssiiissiisssssh...</td>
      <td>0000000000001111111122222233333333334444555550...</td>
      <td>fffffffsssiissssiiiisssssisssssssiiissiisssssh...</td>
      <td>0000000000001111111122222233333333334444555550...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="bpps-sequence-feature">
<h2>BPPS Sequence Feature<a class="headerlink" href="#bpps-sequence-feature" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_matrix</span><span class="p">(</span><span class="n">couples</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>  <span class="c1"># neigbouring bases are linked as well</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">couples</span><span class="p">:</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        
    <span class="k">return</span> <span class="n">mat</span>

<span class="k">def</span> <span class="nf">get_couples</span><span class="p">(</span><span class="n">structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For each closing parenthesis, I find the matching opening one and store their index in the couples list.</span>
<span class="sd">    The assigned list is used to keep track of the assigned opening parenthesis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opened</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">]</span>
    <span class="n">closed</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">opened</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">closed</span><span class="p">)</span>


    <span class="n">assigned</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">couples</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">close_idx</span> <span class="ow">in</span> <span class="n">closed</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">open_idx</span> <span class="ow">in</span> <span class="n">opened</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">open_idx</span> <span class="o">&lt;</span> <span class="n">close_idx</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">open_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">assigned</span><span class="p">:</span>
                    <span class="n">candidate</span> <span class="o">=</span> <span class="n">open_idx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">assigned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
        <span class="n">couples</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">candidate</span><span class="p">,</span> <span class="n">close_idx</span><span class="p">])</span>
        
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">couples</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">opened</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">couples</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">BPPS_Mat</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="n">couples</span> <span class="o">=</span> <span class="n">get_couples</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">build_matrix</span><span class="p">(</span><span class="n">couples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">))</span>
    <span class="n">Select_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">bpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span><span class="n">f</span><span class="s2">&quot;/bpps/</span><span class="si">{Select_id}</span><span class="s2">.npy&quot;</span><span class="p">)</span>
    <span class="n">BPPS_Mat_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mat</span><span class="o">-</span><span class="n">bpp</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">BPPS_Mat_average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">mat</span><span class="o">-</span><span class="n">bpp</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">BPPS_Max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">bpp</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">BPPS_Mat_min</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="n">BPPS_Mat_average</span><span class="p">),</span> 
            <span class="nb">list</span><span class="p">(</span><span class="n">BPPS_Max</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BPPS_Mat_min&#39;</span><span class="p">,</span><span class="s1">&#39;BPPS_Mat_average&#39;</span><span class="p">,</span><span class="s1">&#39;BPPS_Max&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train_df[list_cols] = train_df.apply(BPPS_Mat, axis=1,result_type=&quot;expand&quot;)</span>
<span class="c1"># test_df[list_cols] = test_df.apply(BPPS_Mat, axis=1,result_type=&quot;expand&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="checking">
<h3>checking<a class="headerlink" href="#checking" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># exploded = [train_df[col].explode() for col in list_cols]</span>
<span class="c1"># train_expanded = pd.DataFrame(dict(zip(list_cols, exploded)))</span>
<span class="c1"># train_expanded.reset_index(drop=True, inplace=True)</span>
<span class="c1"># train_expanded[list_cols]  = train_expanded[list_cols].astype(str).astype(float)</span>
<span class="c1"># train_expanded.head()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Train Data New Features correlation (Loop Count)</span>
<span class="c1"># corr = train_expanded.corr()</span>
<span class="c1"># sns.set_context(&quot;notebook&quot;, font_scale=1.0, rc={&quot;lines.linewidth&quot;: 2.5})</span>
<span class="c1"># plt.figure(figsize=(7,5))</span>
<span class="c1"># plt.title(&quot;Train Data New Features correlation (BPPS_Mat_min_row, BPPS_Mat_min_col): &quot;)</span>
<span class="c1"># mask = np.zeros_like(corr)</span>
<span class="c1"># mask[np.triu_indices_from(mask, 1)] = True</span>
<span class="c1"># a = sns.heatmap(corr,mask=mask, annot=True, fmt=&#39;.4f&#39;)</span>
<span class="c1"># rotx = a.set_xticklabels(a.get_xticklabels(), rotation=90)</span>
<span class="c1"># roty = a.set_yticklabels(a.get_yticklabels(), rotation=30)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="pair-map">
<h2>Pair Map<a class="headerlink" href="#pair-map" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mk_pair_map</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">):</span>
    <span class="n">pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">structure</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">pm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">pm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">pd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">pd</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;pm&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pm</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;pd&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;pair_map&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mk_pair_map</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">)</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;pair_map&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mk_pair_map</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">)</span>

<span class="n">train_df</span><span class="p">[</span><span class="s1">&#39;pair_distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mk_pair_map</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">)</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;pair_distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mk_pair_map</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="final-train-and-test-data">
<h2>Final Train And Test Data<a class="headerlink" href="#final-train-and-test-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;train.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>sequence</th>
      <th>structure</th>
      <th>predicted_loop_type</th>
      <th>signal_to_noise</th>
      <th>SN_filter</th>
      <th>seq_length</th>
      <th>seq_scored</th>
      <th>reactivity_error</th>
      <th>...</th>
      <th>centroid_structure</th>
      <th>MEA_structure</th>
      <th>mfe_predicted_loop_type</th>
      <th>mfe_predicted_loop_type_inxex</th>
      <th>centroid_predicted_loop_type</th>
      <th>centroid_predicted_loop_type_inxex</th>
      <th>mea_predicted_loop_type</th>
      <th>mea_predicted_loop_type_inxex</th>
      <th>pair_map</th>
      <th>pair_distance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id_001f94081</td>
      <td>GGAAAAGCUCUAAUAACAGGAGACUAGGACUACGUAUUUCUAGGUA...</td>
      <td>.....((((((.......)))).)).((.....((..((((((......</td>
      <td>EEEEESSSSSSHHHHHHHSSSSBSSXSSIIIIISSIISSSSSSHHH...</td>
      <td>6.894</td>
      <td>1</td>
      <td>107</td>
      <td>68</td>
      <td>[0.1359, 0.20700000000000002, 0.1633, 0.1452, ...</td>
      <td>...</td>
      <td>.......((((.......))))...........................</td>
      <td>.....((((((.......)))).)).((.........((((((......</td>
      <td>fffffsssssshhhhhhhssssissmssiiiiissiisssssshhh...</td>
      <td>0000000111100000001111000022111113322444444111...</td>
      <td>fffffffsssshhhhhhhssssmmmmmmmmmmmmmmmmmmmmmmmm...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>fffffsssssshhhhhhhssssissmssiiiiiiiiisssssshhh...</td>
      <td>0000000111100000001111000022111111111333333111...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.2242990654205...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.1775700934579...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id_0049f53ba</td>
      <td>GGAAAAAGCGCGCGCGGUUAGCGCGCGCUUUUGCGCGCGCUGUACC...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>EEEEESSSSSSSSSSSSSSSSSSSSSSSHHHHSSSSSSSSSSBSSS...</td>
      <td>0.193</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[2.8272, 2.8272, 2.8272, 4.7343, 2.5676, 2.567...</td>
      <td>...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>.....(((((((((((((((((((((((....)))))))))).)))...</td>
      <td>fffffssssssssssssssssssssssshhhhssssssssssisss...</td>
      <td>0000000000000000001111111111000011111111110000...</td>
      <td>fffffssssssssssssssssssssssshhhhssssssssssisss...</td>
      <td>0000000000000000001111111111000011111111110000...</td>
      <td>fffffssssssssssssssssssssssshhhhssssssssssisss...</td>
      <td>0000000000000000001111111111000011111111110000...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.5140186915887...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.4672897196261...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id_006f36f57</td>
      <td>GGAAAGUGCUCAGAUAAGCUAAGCUCGAAUAGCAAUCGAAUAGAAU...</td>
      <td>.....((((.((.....((((.(((.....)))..((((......)...</td>
      <td>EEEEESSSSISSIIIIISSSSMSSSHHHHHSSSMMSSSSHHHHHHS...</td>
      <td>8.800</td>
      <td>1</td>
      <td>107</td>
      <td>68</td>
      <td>[0.0931, 0.13290000000000002, 0.11280000000000...</td>
      <td>...</td>
      <td>...................................((((......)...</td>
      <td>.......((...(.....)...))...........((((......)...</td>
      <td>fffffssssissiiiiissssmssshhhhhsssmmsssshhhhhhs...</td>
      <td>0000000000111111122220333000003331144441111114...</td>
      <td>fffffffffffffffffffffffffffffffffffsssshhhhhhs...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>fffffffssiiishhhhhsiiissmmmmmmmmmmmsssshhhhhhs...</td>
      <td>0000000000001000001000000000000000022221111112...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.6168224299065...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.5700934579439...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id_0082d463b</td>
      <td>GGAAAAGCGCGCGCGCGCGCGCGAAAAAGCGCGCGCGCGCGCGCGC...</td>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
      <td>EEEEEESSSSSSSSSSSSSSSSHHHHHHSSSSSSSSSSSSSSSSSS...</td>
      <td>0.104</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[3.5229, 6.0748, 3.0374, 3.0374, 3.0374, 3.037...</td>
      <td>...</td>
      <td>......((((((((((((((((......)))))))))))))))).....</td>
      <td>......((((((((((((((((......))))))))))))))))((...</td>
      <td>ffffffsssssssssssssssshhhhhhssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000000000000011...</td>
      <td>ffffffsssssssssssssssshhhhhhssssssssssssssssmm...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>ffffffsssssssssssssssshhhhhhssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000000000000011...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.4018691...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.3457943...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id_0087940f4</td>
      <td>GGAAAAUAUAUAAUAUAUUAUAUAAAUAUAUUAUAGAAGUAUAAUA...</td>
      <td>.....(((((((.((((((((((((.(((((((((....)))))))...</td>
      <td>EEEEESSSSSSSBSSSSSSSSSSSSBSSSSSSSSSHHHHSSSSSSS...</td>
      <td>0.423</td>
      <td>0</td>
      <td>107</td>
      <td>68</td>
      <td>[1.665, 2.1728, 2.0041, 1.2405, 0.620200000000...</td>
      <td>...</td>
      <td>......(((((..(((((((((((.((((((((((....)))))))...</td>
      <td>.....((((((.((((((((((((.((((((((((....)))))))...</td>
      <td>fffffsssssssissssssssssssissssssssshhhhsssssss...</td>
      <td>0000000000000111111222222133333333300003333333...</td>
      <td>ffffffsssssiisssssssssssisssssssssshhhhsssssss...</td>
      <td>0000000000000111112222221333333333300003333333...</td>
      <td>fffffssssssissssssssssssisssssssssshhhhsssssss...</td>
      <td>0000000000001111112222221333333333300003333333...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.6261682242990...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.5794392523364...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 54 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;index&#39;, &#39;id&#39;, &#39;sequence&#39;, &#39;structure&#39;, &#39;predicted_loop_type&#39;,
       &#39;signal_to_noise&#39;, &#39;SN_filter&#39;, &#39;seq_length&#39;, &#39;seq_scored&#39;,
       &#39;reactivity_error&#39;, &#39;deg_error_Mg_pH10&#39;, &#39;deg_error_pH10&#39;,
       &#39;deg_error_Mg_50C&#39;, &#39;deg_error_50C&#39;, &#39;reactivity&#39;, &#39;deg_Mg_pH10&#39;,
       &#39;deg_pH10&#39;, &#39;deg_Mg_50C&#39;, &#39;deg_50C&#39;, &#39;stems&#39;, &#39;interior_loops&#39;,
       &#39;multiloops&#39;, &#39;hairpin loops&#39;, &#39;fiveprimes&#39;, &#39;threeprimes&#39;, &#39;A_percent&#39;,
       &#39;G_percent&#39;, &#39;C_percent&#39;, &#39;U_percent&#39;, &#39;U-G&#39;, &#39;C-G&#39;, &#39;U-A&#39;, &#39;G-C&#39;,
       &#39;A-U&#39;, &#39;G-U&#39;, &#39;E&#39;, &#39;S&#39;, &#39;H&#39;, &#39;B&#39;, &#39;X&#39;, &#39;I&#39;, &#39;M&#39;, &#39;pairs_rate&#39;,
       &#39;mfe_structure&#39;, &#39;centroid_structure&#39;, &#39;MEA_structure&#39;,
       &#39;mfe_predicted_loop_type&#39;, &#39;mfe_predicted_loop_type_inxex&#39;,
       &#39;centroid_predicted_loop_type&#39;, &#39;centroid_predicted_loop_type_inxex&#39;,
       &#39;mea_predicted_loop_type&#39;, &#39;mea_predicted_loop_type_inxex&#39;, &#39;pair_map&#39;,
       &#39;pair_distance&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;index&#39;, &#39;id&#39;, &#39;sequence&#39;, &#39;structure&#39;, &#39;predicted_loop_type&#39;,
       &#39;seq_length&#39;, &#39;seq_scored&#39;, &#39;stems&#39;, &#39;interior_loops&#39;, &#39;multiloops&#39;,
       &#39;hairpin loops&#39;, &#39;fiveprimes&#39;, &#39;threeprimes&#39;, &#39;A_percent&#39;, &#39;G_percent&#39;,
       &#39;C_percent&#39;, &#39;U_percent&#39;, &#39;U-G&#39;, &#39;C-G&#39;, &#39;U-A&#39;, &#39;G-C&#39;, &#39;A-U&#39;, &#39;G-U&#39;, &#39;E&#39;,
       &#39;S&#39;, &#39;H&#39;, &#39;B&#39;, &#39;X&#39;, &#39;I&#39;, &#39;M&#39;, &#39;pairs_rate&#39;, &#39;mfe_structure&#39;,
       &#39;centroid_structure&#39;, &#39;MEA_structure&#39;, &#39;mfe_predicted_loop_type&#39;,
       &#39;mfe_predicted_loop_type_inxex&#39;, &#39;centroid_predicted_loop_type&#39;,
       &#39;centroid_predicted_loop_type_inxex&#39;, &#39;mea_predicted_loop_type&#39;,
       &#39;mea_predicted_loop_type_inxex&#39;, &#39;pair_map&#39;, &#39;pair_distance&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>sequence</th>
      <th>structure</th>
      <th>predicted_loop_type</th>
      <th>seq_length</th>
      <th>seq_scored</th>
      <th>stems</th>
      <th>interior_loops</th>
      <th>multiloops</th>
      <th>...</th>
      <th>centroid_structure</th>
      <th>MEA_structure</th>
      <th>mfe_predicted_loop_type</th>
      <th>mfe_predicted_loop_type_inxex</th>
      <th>centroid_predicted_loop_type</th>
      <th>centroid_predicted_loop_type_inxex</th>
      <th>mea_predicted_loop_type</th>
      <th>mea_predicted_loop_type_inxex</th>
      <th>pair_map</th>
      <th>pair_distance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id_00073f8be</td>
      <td>GGAAAAGUACGACUUGAGUACGGAAAACGUACCAACUCGAUUAAAA...</td>
      <td>......((((((((((.(((((.....))))))))((((((((......</td>
      <td>EEEEEESSSSSSSSSSBSSSSSHHHHHSSSSSSSSSSSSSSSSHHH...</td>
      <td>107</td>
      <td>68</td>
      <td>[0.06542056074766354, 0.06542056074766354, 0.0...</td>
      <td>[0.028037383177570093, 0.028037383177570093, 0...</td>
      <td>[0.037383177570093455, 0.037383177570093455, 0...</td>
      <td>...</td>
      <td>.........((((.((.(((((.....)))))))....(((((......</td>
      <td>.........(((((((.(((((.....)))))))..(((((((......</td>
      <td>ffffffssssssssssissssshhhhhsssssssssssssssshhh...</td>
      <td>0000000001111222033333000003333322244455555111...</td>
      <td>fffffffffssssmssissssshhhhhsssssssmmmmssssshhh...</td>
      <td>0000000000000011022222000002222211111133333111...</td>
      <td>fffffffffsssssssissssshhhhhsssssssmmssssssshhh...</td>
      <td>0000000000000011022222000002222211113344444111...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6168224...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5607476...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id_000ae4237</td>
      <td>GGAAACGGGUUCCGCGGAUUGCUGCUAAUAAGAGUAAUCUCUAAAU...</td>
      <td>.....((((..((((((...(((((.....((((....)))).......</td>
      <td>EEEEESSSSIISSSSSSIIISSSSSIIIIISSSSHHHHSSSSIIII...</td>
      <td>130</td>
      <td>91</td>
      <td>[0.05384615384615385, 0.05384615384615385, 0.0...</td>
      <td>[0.023076923076923078, 0.023076923076923078, 0...</td>
      <td>[0.03076923076923077, 0.03076923076923077, 0.0...</td>
      <td>...</td>
      <td>.....((((..((((((...(((((.....((((....)))).......</td>
      <td>.....((((..((((((...(((((.....((((....)))).......</td>
      <td>fffffssssiissssssiiisssssiiiiisssshhhhssssiiii...</td>
      <td>0000000000011122211133333222224444000044442222...</td>
      <td>fffffssssiissssssiiisssssiiiiisssshhhhssssiiii...</td>
      <td>0000000000011122211133333222224444000044442222...</td>
      <td>fffffssssiissssssiiisssssiiiiisssshhhhssssiiii...</td>
      <td>0000000000011122211133333222224444000044442222...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.6615384615384...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.6230769230769...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id_00131c573</td>
      <td>GGAAAACAAAACGGCCUGGAAGACGAAGGAAUUCGGCGCGAAGGCC...</td>
      <td>...........((.(((.(.(..((..((..((((...))))..))...</td>
      <td>EEEEEEEEEEESSISSSISISIISSIISSIISSSSHHHSSSSIISS...</td>
      <td>107</td>
      <td>68</td>
      <td>[0.07476635514018691, 0.07476635514018691, 0.0...</td>
      <td>[0.056074766355140186, 0.056074766355140186, 0...</td>
      <td>[0.009345794392523364, 0.009345794392523364, 0...</td>
      <td>...</td>
      <td>...........((.(((.(.(..((..((..((((...))))..))...</td>
      <td>...........((.(((.(.(..((..((..((((...))))..))...</td>
      <td>fffffffffffssisssisisiissiissiisssshhhssssiiss...</td>
      <td>0000000000000011112233344445555666600066665555...</td>
      <td>fffffffffffssisssisisiissiissiisssshhhssssiiss...</td>
      <td>0000000000000011112233344445555666600066665555...</td>
      <td>fffffffffffssisssisisiissiissiisssshhhssssiiss...</td>
      <td>0000000000000011112233344445555666600066665555...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1....</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1....</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id_00181fd34</td>
      <td>GGAAAGGAUCUCUAUCGAAGGAUAGAGAUCGCUCGCGACGGCACGA...</td>
      <td>......((((((((((....))))))))))((((((..((.(((.....</td>
      <td>EEEEEESSSSSSSSSSHHHHSSSSSSSSSSSSSSSSIISSISSSHH...</td>
      <td>107</td>
      <td>68</td>
      <td>[0.04672897196261682, 0.04672897196261682, 0.0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>[0.018691588785046728, 0.018691588785046728, 0...</td>
      <td>...</td>
      <td>......((((((((((....))))))))))((((((..((.(((.....</td>
      <td>......((((((((((....))))))))))((((((..((.(((.....</td>
      <td>ffffffsssssssssshhhhssssssssssssssssiississshh...</td>
      <td>0000000000000000000000000000001111110022133311...</td>
      <td>ffffffsssssssssshhhhssssssssssssssssiississshh...</td>
      <td>0000000000000000000000000000001111110022133311...</td>
      <td>ffffffsssssssssshhhhssssssssssssssssiississshh...</td>
      <td>0000000000000000000000000000001111110022133311...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.2710280...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.2149532...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id_0020473f7</td>
      <td>GGAAACCCGCCCGCGCCCGCCCGCGCUGCUGCCGUGCCUCCUCUCC...</td>
      <td>.....(((((((((((((((((((((((((((((((((((((((((...</td>
      <td>EEEEESSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS...</td>
      <td>130</td>
      <td>91</td>
      <td>[0.015384615384615385, 0.015384615384615385, 0...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>[0.007692307692307693, 0.007692307692307693, 0...</td>
      <td>...</td>
      <td>.....(((((((((((((((((((((((((((((((((((((((((...</td>
      <td>.....(((((((((((((((((((((((((((((((((((((((((...</td>
      <td>fffffsssssssssssssssssssssssssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>fffffsssssssssssssssssssssssssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>fffffsssssssssssssssssssssssssssssssssssssssss...</td>
      <td>0000000000000000000000000000000000000000000000...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.6923076923076...</td>
      <td>[-1.0, -1.0, -1.0, -1.0, -1.0, 0.6538461538461...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 42 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2400, 54)
(3634, 42)
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Things_we_tried"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="CV_strategy.html" title="previous page">Stratification by the signal_to_noise</a>
    <a class='right-next' id="next-link" href="augmentation.html" title="next page">structure augmentation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Vatsal Parsaniya , Meet Ranoliya<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>